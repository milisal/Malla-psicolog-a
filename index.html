<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular PsicologÃ­a</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-color: #fff6f8;
      --column-bg: #ffeef4;
      --border-color: #e7b6c7;
      --primary-text: #78244c;
      --course-bg: #fbdde7;
      --completed-bg: #e2f5e9;
      --locked-bg: #f8d2da;
      --tooltip-bg: #c94a63;
      --check-color-light: #b3365c;
    }

    body.dark-mode {
      --bg-color: #3b0a28;
      --column-bg: #4d0f35;
      --border-color: #72254c;
      --primary-text: #ffeaf3;
      --course-bg: #7c2947;
      --completed-bg: #4a5a4f;
      --locked-bg: #723244;
      --tooltip-bg: #ae3658;
      --check-color-dark: #7a1839;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-color);
      padding: 20px;
      color: var(--primary-text);
      transition: background-color 0.3s ease, color 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding-top: 70px;
    }

    h1 {
      text-align: center;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .toggle-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      gap: 10px;
    }

    .toggle-container button {
      padding: 8px 16px;
      background-color: var(--tooltip-bg);
      color: white;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
    }

    .toggle-container button:hover {
      background-color: #a23650;
    }

    .progress {
      text-align: center;
      margin-bottom: 30px;
      font-size: 1rem;
      font-weight: 600;
    }

    .grid {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding: 10px 0;
      max-width: 1200px;
      justify-content: center;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .column {
      flex: 0 0 auto;
      background-color: var(--column-bg);
      border-radius: 16px;
      padding: 16px;
      min-width: 250px;
      border: 2px solid var(--border-color);
      box-sizing: border-box;
      color: var(--primary-text);
      transition: background-color 0.3s, border-color 0.3s, color 0.3s;
    }

    .column.cbc,
    .column.formacion-general,
    .column.formacion-profesional,
    .column.requisitos-de-tesis {
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
      border: 3px solid var(--tooltip-bg);
      background-image: linear-gradient(135deg, rgba(255, 182, 193, 0.2), rgba(255, 105, 180, 0.2));
    }

    body.dark-mode .column.cbc,
    body.dark-mode .column.formacion-general,
    body.dark-mode .column.formacion-profesional,
    body.dark-mode .column.requisitos-de-tesis {
      background-image: linear-gradient(135deg, rgba(139, 0, 45, 0.2), rgba(90, 0, 30, 0.2));
    }

    .column h2 {
      text-align: center;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .course {
      background-color: var(--course-bg);
      border-radius: 12px;
      padding: 10px;
      margin: 8px 0;
      position: relative;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      border: 1px solid var(--border-color);
      color: var(--primary-text);
      user-select: none;
    }

    .course.completed {
      background-color: var(--completed-bg);
      text-decoration: line-through;
    }

    .course.locked {
      background-color: var(--locked-bg);
      opacity: 0.7;
      cursor: default;
      color: #999;
      border-color: #ccc;
    }

    .course .tooltip {
      visibility: hidden;
      opacity: 0;
      background-color: var(--tooltip-bg);
      color: white;
      padding: 6px 12px;
      border-radius: 999px;
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      white-space: nowrap;
      transition: opacity 0.3s;
      font-size: 0.8rem;
      z-index: 10;
      pointer-events: none;
    }

    .course:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }

    .checkmark {
      float: right;
      font-weight: bold;
      user-select: none;
      color: var(--check-color-light);
      transition: color 0.3s;
    }

    body.dark-mode .checkmark {
      color: var(--check-color-dark);
    }
  </style>
</head>
<body>
  <div class="toggle-container">
    <button id="darkModeBtn">Alternar modo oscuro</button>
    <button id="colorBtn">ðŸŽ¨ Personalizar colores</button>
  </div>
  <h1>Malla Curricular â€“ Lic. en PsicologÃ­a</h1>
  <div class="progress" id="tesisProgress"></div>
  <div class="grid" id="curriculum"></div>

  <div id="colorControls" style="display:none; position:fixed; top:80px; right:20px; background:white; border:1px solid #ccc; padding:10px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.2); z-index:1000;">
    <label>Color de fondo:<input type="color" id="bgColorPicker"></label><br>
    <label>Color columnas:<input type="color" id="columnBgPicker"></label><br>
    <label>Color texto:<input type="color" id="textColorPicker"></label>
  </div>

  <script src="js/data.js"></script>
  <script src="js/app.js"></script>
  <script>
    document.getElementById("colorBtn").addEventListener("click", () => {
      const panel = document.getElementById("colorControls");
      panel.style.display = panel.style.display === "none" ? "block" : "none";
    });

    document.getElementById("bgColorPicker").addEventListener("input", (e) => {
      document.documentElement.style.setProperty('--bg-color', e.target.value);
    });

    document.getElementById("columnBgPicker").addEventListener("input", (e) => {
      document.documentElement.style.setProperty('--column-bg', e.target.value);
    });

    document.getElementById("textColorPicker").addEventListener("input", (e) => {
      document.documentElement.style.setProperty('--primary-text', e.target.value);
    });

  <script>
    const data = {
      'CBC': [
        'BiologÃ­a', 'SemiologÃ­a', 'PsicologÃ­a', 'Pensamiento cientÃ­fico', 'MatemÃ¡tica', 'Sociedad y Estado'
      ],
      'FormaciÃ³n General': [
        { name: 'PsicologÃ­a General', reqs: ['CBC'] },
        { name: 'EstadÃ­stica', reqs: ['CBC'] },
        { name: 'PsicologÃ­a Social', reqs: ['CBC'] },
        { name: 'PsicoanÃ¡lisis Freud', reqs: ['CBC'] },
        { name: 'Psic. Y Epist. GenÃ©tica', reqs: ['CBC'] },
        { name: 'NeurofisiologÃ­a', reqs: ['CBC'] },
        { name: 'Historia de la PsicologÃ­a', reqs: ['PsicologÃ­a General'] },
        { name: 'MetodologÃ­a de la InvestigaciÃ³n', reqs: ['PsicologÃ­a General', 'EstadÃ­stica'] },
        { name: 'Salud PÃºblica y Mental', reqs: ['PsicologÃ­a Social', 'MetodologÃ­a de la InvestigaciÃ³n'] },
        { name: 'TeorÃ­a y TÃ©cnica de Grupos', reqs: ['PsicologÃ­a Social', 'PsicoanÃ¡lisis Freud'] },
        { name: 'Ps. Evolutiva NiÃ±ez', reqs: ['PsicoanÃ¡lisis Freud', 'Psic. Y Epist. GenÃ©tica'] },
        { name: 'Ps. Evolutiva Adolescencia', reqs: ['Ps. Evolutiva NiÃ±ez'] },
        { name: 'PsicopatologÃ­a', reqs: ['NeurofisiologÃ­a', 'Ps. Evolutiva Adolescencia'] },
        { name: 'T. Y T de Explor. Diag. Ps. MÃ³d I', reqs: ['MetodologÃ­a de la InvestigaciÃ³n', 'PsicopatologÃ­a'] },
        { name: 'T. Y T de Explor. Diag. Ps. MÃ³d II', reqs: ['T. Y T de Explor. Diag. Ps. MÃ³d I'] },
        { name: 'Materia Electiva I' },
        { name: 'Requisito Idioma', reqs: ['PsicologÃ­a General', 'PsicoanÃ¡lisis Freud'] },
        { name: 'Materia Electiva II' }
      ],
      'FormaciÃ³n Profesional': [
        { name: 'Ps. Ã‰tica y DDHH', reqs: ['PsicologÃ­a Social', 'Historia de la PsicologÃ­a'] },
        { name: 'PsicologÃ­a Educacional', reqs: ['Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos', 'Ps. Evolutiva Adolescencia'] },
        { name: 'PsicologÃ­a Institucional', reqs: ['Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos'] },
        { name: 'PsicologÃ­a del Trabajo', reqs: ['Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos', 'T. Y T de Explor. Diag. Ps. MÃ³d II'] },
        { name: 'CP y P. ClÃ­nica de Adultos', reqs: ['T. Y T de Explor. Diag. Ps. MÃ³d II'] },
        { name: 'PsicologÃ­a JurÃ­dica', reqs: ['T. Y T de Explor. Diag. Ps. MÃ³d II'] },
        { name: 'Psicoterapias', reqs: ['T. Y T de Explor. Diag. Ps. MÃ³d II'] },
        { name: 'PrÃ¡ctica prof. o de InvestigaciÃ³n', reqs: [
          'PsicologÃ­a General', 'EstadÃ­stica', 'PsicologÃ­a Social', 'PsicoanÃ¡lisis Freud', 'Psic. Y Epist. GenÃ©tica', 'NeurofisiologÃ­a', 'Historia de la PsicologÃ­a', 
          'MetodologÃ­a de la InvestigaciÃ³n', 'Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos', 'Ps. Evolutiva NiÃ±ez', 'Ps. Evolutiva Adolescencia', 'PsicopatologÃ­a',
          'T. Y T de Explor. Diag. Ps. MÃ³d I', 'T. Y T de Explor. Diag. Ps. MÃ³d II', 'Requisito Idioma'
        ] },
        { name: 'Materia Electiva/PrÃ¡ctica', reqs: [
          'PsicologÃ­a General', 'EstadÃ­stica', 'PsicologÃ­a Social', 'PsicoanÃ¡lisis Freud', 'Psic. Y Epist. GenÃ©tica', 'NeurofisiologÃ­a', 'Historia de la PsicologÃ­a', 
          'MetodologÃ­a de la InvestigaciÃ³n', 'Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos', 'Ps. Evolutiva NiÃ±ez', 'Ps. Evolutiva Adolescencia', 'PsicopatologÃ­a',
          'T. Y T de Explor. Diag. Ps. MÃ³d I', 'T. Y T de Explor. Diag. Ps. MÃ³d II', 'Requisito Idioma'
        ] },
        { name: 'Materia Electiva III', reqs: [
          'PsicologÃ­a General', 'EstadÃ­stica', 'PsicologÃ­a Social', 'PsicoanÃ¡lisis Freud', 'Psic. Y Epist. GenÃ©tica', 'NeurofisiologÃ­a', 'Historia de la PsicologÃ­a', 
          'MetodologÃ­a de la InvestigaciÃ³n', 'Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos', 'Ps. Evolutiva NiÃ±ez', 'Ps. Evolutiva Adolescencia', 'PsicopatologÃ­a',
          'T. Y T de Explor. Diag. Ps. MÃ³d I', 'T. Y T de Explor. Diag. Ps. MÃ³d II', 'Requisito Idioma'
        ] },
        { name: 'Materia Electiva IV', reqs: [
          'PsicologÃ­a General', 'EstadÃ­stica', 'PsicologÃ­a Social', 'PsicoanÃ¡lisis Freud', 'Psic. Y Epist. GenÃ©tica', 'NeurofisiologÃ­a', 'Historia de la PsicologÃ­a', 
          'MetodologÃ­a de la InvestigaciÃ³n', 'Salud PÃºblica y Mental', 'TeorÃ­a y TÃ©cnica de Grupos', 'Ps. Evolutiva NiÃ±ez', 'Ps. Evolutiva Adolescencia', 'PsicopatologÃ­a',
          'T. Y T de Explor. Diag. Ps. MÃ³d I', 'T. Y T de Explor. Diag. Ps. MÃ³d II', 'Requisito Idioma'
        ] },
        { name: 'Requisito Tesis', reqs: [
          'BiologÃ­a', 'SemiologÃ­a', 'PsicologÃ­a', 'Pensamiento cientÃ­fico', 'MatemÃ¡tica', 'Sociedad y Estado',
          'PsicologÃ­a General', 'EstadÃ­stica', 'PsicologÃ­a Social', 'PsicoanÃ¡lisis Freud', 'Psic. Y Epist. GenÃ©tica',
          'NeurofisiologÃ­a', 'Historia de la PsicologÃ­a', 'MetodologÃ­a de la InvestigaciÃ³n', 'Salud PÃºblica y Mental',
          'TeorÃ­a y TÃ©cnica de Grupos', 'Ps. Evolutiva NiÃ±ez', 'Ps. Evolutiva Adolescencia', 'PsicopatologÃ­a',
          'T. Y T de Explor. Diag. Ps. MÃ³d I', 'T. Y T de Explor. Diag. Ps. MÃ³d II', 'Materia Electiva I',
          'Requisito Idioma', 'Materia Electiva II', 'Ps. Ã‰tica y DDHH', 'PsicologÃ­a Educacional', 'PsicologÃ­a Institucional',
          'PsicologÃ­a del Trabajo', 'CP y P. ClÃ­nica de Adultos', 'PsicologÃ­a JurÃ­dica', 'Psicoterapias',
          'PrÃ¡ctica prof. o de InvestigaciÃ³n', 'Materia Electiva/PrÃ¡ctica', 'Materia Electiva III', 'Materia Electiva IV'
        ] }
      ]
    };

    const completed = JSON.parse(localStorage.getItem('completedCourses') || '[]');

function isCompleted(name) {
  return completed.includes(name);
}

function checkRequirements(reqs) {
  if (!reqs || reqs.length === 0) return true;
  return reqs.every(r => {
    if (r === 'CBC') {
      return data['CBC'].every(isCompleted);
    } else {
      return isCompleted(r);
    }
  });
}

function updateTesisProgress() {
  const tesis = data['FormaciÃ³n Profesional'].find(c => c.name === 'Requisito Tesis');
  if (!tesis) {
    document.getElementById('tesisProgress').textContent = '';
    return;
  }
  const total = tesis.reqs.length;
  const done = tesis.reqs.filter(isCompleted).length;
  document.getElementById('tesisProgress').textContent = `Progreso hacia Tesis: ${done}/${total} materias completadas`;
}

function render() {
  updateTesisProgress();
  const container = document.getElementById('curriculum');
  container.innerHTML = '';

  for (const [cycle, courses] of Object.entries(data)) {
    const col = document.createElement('div');
    let className = cycle.toLowerCase()
      .normalize("NFD").replace(/[\u0300-\u036f]/g, "")
      .replace(/\s+/g, '-');
    col.className = 'column ' + className;
    col.innerHTML = `<h2>${cycle}</h2>`;

    courses.forEach(course => {
      const name = typeof course === 'string' ? course : course.name;
      const reqs = typeof course === 'string' ? [] : course.reqs;
      const isDone = isCompleted(name);
      const unlocked = checkRequirements(reqs);

      const div = document.createElement('div');
      div.className = 'course';
      if (isDone) div.classList.add('completed');
      if (!unlocked) div.classList.add('locked');

      div.innerHTML = `${name}${isDone ? '<span class="checkmark">âœ“</span>' : ''}`;

      if (!unlocked && reqs.length) {
        const tooltip = document.createElement('span');
        tooltip.className = 'tooltip';
        const unmet = reqs.filter(r =>
          r === 'CBC' ? !data['CBC'].every(isCompleted) : !isCompleted(r)
        );
        tooltip.textContent = `Falta: ${unmet.join(', ')}`;
        div.appendChild(tooltip);
      }

      div.onclick = () => {
        if (!unlocked) return;
        if (isDone) {
          completed.splice(completed.indexOf(name), 1);
        } else {
          completed.push(name);
        }
        localStorage.setItem('completedCourses', JSON.stringify(completed));
        render();
      };

      col.appendChild(div);
    });

    container.appendChild(col);
  }
}

function toggleDarkMode() {
  document.body.classList.toggle('dark-mode');
  localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
  document.getElementById('darkModeBtn').textContent = document.body.classList.contains('dark-mode') ? 'Modo claro' : 'Modo oscuro';
}

// Restaurar modo oscuro si estaba activado
if (localStorage.getItem('darkMode') === 'true') {
  document.body.classList.add('dark-mode');
}

document.getElementById('darkModeBtn').textContent =
  document.body.classList.contains('dark-mode') ? 'Modo claro' : 'Modo oscuro';

document.getElementById('darkModeBtn').addEventListener('click', toggleDarkMode);

render();
    
