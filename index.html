<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular Psicolog√≠a</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-color: #fff6f8;
      --column-bg: #ffeef4;
      --border-color: #e7b6c7;
      --primary-text: #78244c;
      --course-bg: #fbdde7;
      --completed-bg: #e2f5e9;
      --locked-bg: #f8d2da;
      --tooltip-bg: #c94a63;
      --check-color-light: #b3365c;
    }

    body.dark-mode {
      --bg-color: #3b0a28;
      --column-bg: #4d0f35;
      --border-color: #72254c;
      --primary-text: #ffeaf3;
      --course-bg: #7c2947;
      --completed-bg: #4a5a4f;
      --locked-bg: #723244;
      --tooltip-bg: #ae3658;
      --check-color-dark: #7a1839;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-color);
      padding: 20px;
      color: var(--primary-text);
      transition: background-color 0.3s ease, color 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding-top: 100px;
    }

    h1 {
      text-align: center;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .toggle-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
    }

    .toggle-container button {
      padding: 8px 16px;
      background-color: var(--tooltip-bg);
      color: white;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
      margin-bottom: 10px;
    }

    .toggle-container button:hover {
      background-color: #a23650;
    }

    .color-panel {
      position: fixed;
      top: 100px;
      right: 20px;
      background: white;
      border: 2px solid var(--border-color);
      border-radius: 16px;
      padding: 16px;
      z-index: 1000;
      width: 280px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      display: none;
      flex-direction: column;
      gap: 10px;
      font-size: 0.9rem;
    }

    .color-panel input[type="color"] {
      width: 100%;
      height: 30px;
      border: none;
      padding: 0;
      cursor: pointer;
    }

    .color-panel label {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .color-panel button {
      padding: 6px 12px;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 5px;
      background-color: var(--tooltip-bg);
      color: white;
    }

    .progress {
      text-align: center;
      margin-bottom: 30px;
      font-size: 1rem;
      font-weight: 600;
    }

    .grid {
      display: flex;
      gap: 20px;
      overflow-x: auto;
      padding: 10px 0;
      max-width: 1200px;
      justify-content: center;
      margin: 0 auto;
      box-sizing: border-box;
    }

    .column {
      flex: 0 0 auto;
      background-color: var(--column-bg);
      border-radius: 16px;
      padding: 16px;
      min-width: 250px;
      border: 2px solid var(--border-color);
      box-sizing: border-box;
      color: var(--primary-text);
      transition: background-color 0.3s, border-color 0.3s, color 0.3s;
    }

    .column h2 {
      position: relative;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.15);
      border: 2px solid var(--primary-text);
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="toggle-container">
    <button id="darkModeBtn">Alternar modo oscuro</button>
    <button id="colorBtn">üé® Personalizar colores</button>
  </div>
  <div class="color-panel" id="colorPanel">
    <div class="color-toggle">
      <label>
        Modo:
        <select id="modeSelector">
          <option value="light">Claro</option>
          <option value="dark">Oscuro</option>
        </select>
      </label>
    </div>
    <label>Fondo: <input type="color" id="bg-color"></label>
    <label>Columna: <input type="color" id="column-bg"></label>
    <label>Texto: <input type="color" id="primary-text"></label>
    <label>Materia: <input type="color" id="course-bg"></label>
    <label>Completado: <input type="color" id="completed-bg"></label>
    <label>Bloqueado: <input type="color" id="locked-bg"></label>
    <button onclick="saveCustomColors()">Guardar</button>
    <button onclick="resetColors()">Restablecer</button>
  </div>
  <script>
    const data = {
      'CBC': [
        'Biolog√≠a', 'Semiolog√≠a', 'Psicolog√≠a', 'Pensamiento cient√≠fico', 'Matem√°tica', 'Sociedad y Estado'
      ],
      'Formaci√≥n General': [
        { name: 'Psicolog√≠a General', reqs: ['CBC'] },
        { name: 'Estad√≠stica', reqs: ['CBC'] },
        { name: 'Psicolog√≠a Social', reqs: ['CBC'] },
        { name: 'Psicoan√°lisis Freud', reqs: ['CBC'] },
        { name: 'Psic. Y Epist. Gen√©tica', reqs: ['CBC'] },
        { name: 'Neurofisiolog√≠a', reqs: ['CBC'] },
        { name: 'Historia de la Psicolog√≠a', reqs: ['Psicolog√≠a General'] },
        { name: 'Metodolog√≠a de la Investigaci√≥n', reqs: ['Psicolog√≠a General', 'Estad√≠stica'] },
        { name: 'Salud P√∫blica y Mental', reqs: ['Psicolog√≠a Social', 'Metodolog√≠a de la Investigaci√≥n'] },
        { name: 'Teor√≠a y T√©cnica de Grupos', reqs: ['Psicolog√≠a Social', 'Psicoan√°lisis Freud'] },
        { name: 'Ps. Evolutiva Ni√±ez', reqs: ['Psicoan√°lisis Freud', 'Psic. Y Epist. Gen√©tica'] },
        { name: 'Ps. Evolutiva Adolescencia', reqs: ['Ps. Evolutiva Ni√±ez'] },
        { name: 'Psicopatolog√≠a', reqs: ['Neurofisiolog√≠a', 'Ps. Evolutiva Adolescencia'] },
        { name: 'T. Y T de Explor. Diag. Ps. M√≥d I', reqs: ['Metodolog√≠a de la Investigaci√≥n', 'Psicopatolog√≠a'] },
        { name: 'T. Y T de Explor. Diag. Ps. M√≥d II', reqs: ['T. Y T de Explor. Diag. Ps. M√≥d I'] },
        { name: 'Materia Electiva I' },
        { name: 'Requisito Idioma', reqs: ['Psicolog√≠a General', 'Psicoan√°lisis Freud'] },
        { name: 'Materia Electiva II' }
      ],
      'Formaci√≥n Profesional': [
        { name: 'Ps. √âtica y DDHH', reqs: ['Psicolog√≠a Social', 'Historia de la Psicolog√≠a'] },
        { name: 'Psicolog√≠a Educacional', reqs: ['Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos', 'Ps. Evolutiva Adolescencia'] },
        { name: 'Psicolog√≠a Institucional', reqs: ['Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos'] },
        { name: 'Psicolog√≠a del Trabajo', reqs: ['Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos', 'T. Y T de Explor. Diag. Ps. M√≥d II'] },
        { name: 'CP y P. Cl√≠nica de Adultos', reqs: ['T. Y T de Explor. Diag. Ps. M√≥d II'] },
        { name: 'Psicolog√≠a Jur√≠dica', reqs: ['T. Y T de Explor. Diag. Ps. M√≥d II'] },
        { name: 'Psicoterapias', reqs: ['T. Y T de Explor. Diag. Ps. M√≥d II'] },
        { name: 'Pr√°ctica prof. o de Investigaci√≥n', reqs: [
          'Psicolog√≠a General', 'Estad√≠stica', 'Psicolog√≠a Social', 'Psicoan√°lisis Freud', 'Psic. Y Epist. Gen√©tica', 'Neurofisiolog√≠a', 'Historia de la Psicolog√≠a',
          'Metodolog√≠a de la Investigaci√≥n', 'Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos', 'Ps. Evolutiva Ni√±ez', 'Ps. Evolutiva Adolescencia', 'Psicopatolog√≠a',
          'T. Y T de Explor. Diag. Ps. M√≥d I', 'T. Y T de Explor. Diag. Ps. M√≥d II', 'Requisito Idioma'
        ] },
        { name: 'Materia Electiva/Pr√°ctica', reqs: [
          'Psicolog√≠a General', 'Estad√≠stica', 'Psicolog√≠a Social', 'Psicoan√°lisis Freud', 'Psic. Y Epist. Gen√©tica', 'Neurofisiolog√≠a', 'Historia de la Psicolog√≠a',
          'Metodolog√≠a de la Investigaci√≥n', 'Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos', 'Ps. Evolutiva Ni√±ez', 'Ps. Evolutiva Adolescencia', 'Psicopatolog√≠a',
          'T. Y T de Explor. Diag. Ps. M√≥d I', 'T. Y T de Explor. Diag. Ps. M√≥d II', 'Requisito Idioma'
        ] },
        { name: 'Materia Electiva III', reqs: [
          'Psicolog√≠a General', 'Estad√≠stica', 'Psicolog√≠a Social', 'Psicoan√°lisis Freud', 'Psic. Y Epist. Gen√©tica', 'Neurofisiolog√≠a', 'Historia de la Psicolog√≠a',
          'Metodolog√≠a de la Investigaci√≥n', 'Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos', 'Ps. Evolutiva Ni√±ez', 'Ps. Evolutiva Adolescencia', 'Psicopatolog√≠a',
          'T. Y T de Explor. Diag. Ps. M√≥d I', 'T. Y T de Explor. Diag. Ps. M√≥d II', 'Requisito Idioma'
        ] },
        { name: 'Materia Electiva IV', reqs: [
          'Psicolog√≠a General', 'Estad√≠stica', 'Psicolog√≠a Social', 'Psicoan√°lisis Freud', 'Psic. Y Epist. Gen√©tica', 'Neurofisiolog√≠a', 'Historia de la Psicolog√≠a',
          'Metodolog√≠a de la Investigaci√≥n', 'Salud P√∫blica y Mental', 'Teor√≠a y T√©cnica de Grupos', 'Ps. Evolutiva Ni√±ez', 'Ps. Evolutiva Adolescencia', 'Psicopatolog√≠a',
          'T. Y T de Explor. Diag. Ps. M√≥d I', 'T. Y T de Explor. Diag. Ps. M√≥d II', 'Requisito Idioma'
        ] },
        { name: 'Requisito Tesis', reqs: [
          'Biolog√≠a', 'Semiolog√≠a', 'Psicolog√≠a', 'Pensamiento cient√≠fico', 'Matem√°tica', 'Sociedad y Estado',
          'Psicolog√≠a General', 'Estad√≠stica', 'Psicolog√≠a Social', 'Psicoan√°lisis Freud', 'Psic. Y Epist. Gen√©tica',
          'Neurofisiolog√≠a', 'Historia de la Psicolog√≠a', 'Metodolog√≠a de la Investigaci√≥n', 'Salud P√∫blica y Mental',
          'Teor√≠a y T√©cnica de Grupos', 'Ps. Evolutiva Ni√±ez', 'Ps. Evolutiva Adolescencia', 'Psicopatolog√≠a',
          'T. Y T de Explor. Diag. Ps. M√≥d I', 'T. Y T de Explor. Diag. Ps. M√≥d II', 'Materia Electiva I',
          'Requisito Idioma', 'Materia Electiva II', 'Ps. √âtica y DDHH', 'Psicolog√≠a Educacional', 'Psicolog√≠a Institucional',
          'Psicolog√≠a del Trabajo', 'CP y P. Cl√≠nica de Adultos', 'Psicolog√≠a Jur√≠dica', 'Psicoterapias',
          'Pr√°ctica prof. o de Investigaci√≥n', 'Materia Electiva/Pr√°ctica', 'Materia Electiva III', 'Materia Electiva IV'
        ] }
      ]
    };

    const completed = JSON.parse(localStorage.getItem('completedCourses') || '[]');

    function isCompleted(name) {
      return completed.includes(name);
    }

    function checkRequirements(reqs) {
      if (!reqs || reqs.length === 0) return true;
      return reqs.every(r => r === 'CBC' ? data['CBC'].every(isCompleted) : isCompleted(r));
    }

    function updateTesisProgress() {
      const tesis = data['Formaci√≥n Profesional'].find(c => c.name === 'Requisito Tesis');
      const total = tesis.reqs.length;
      const done = tesis.reqs.filter(isCompleted).length;
      const progress = document.createElement('div');
      progress.className = 'progress';
      progress.textContent = `Progreso hacia Tesis: ${done}/${total} materias completadas`;
      document.body.insertBefore(progress, document.querySelector('.grid'));
    }

    function render() {
      const grid = document.createElement('div');
      grid.className = 'grid';

      for (const [cycle, courses] of Object.entries(data)) {
        const col = document.createElement('div');
        col.className = 'column';

        const title = document.createElement('h2');
        title.textContent = cycle;
        col.appendChild(title);

        courses.forEach(course => {
          const name = typeof course === 'string' ? course : course.name;
          const reqs = typeof course === 'string' ? [] : course.reqs;
          const unlocked = checkRequirements(reqs);
          const done = isCompleted(name);

          const div = document.createElement('div');
          div.className = 'course';
          if (done) div.classList.add('completed');
          if (!unlocked) div.classList.add('locked');

          div.textContent = name;

          if (done) {
            const check = document.createElement('span');
            check.className = 'checkmark';
            check.textContent = '‚úì';
            div.appendChild(check);
          }

          if (!unlocked && reqs.length) {
            const tooltip = document.createElement('span');
            tooltip.className = 'tooltip';
            tooltip.textContent = 'Falta: ' + reqs.filter(r => r === 'CBC' ? !data['CBC'].every(isCompleted) : !isCompleted(r)).join(', ');
            div.appendChild(tooltip);
          }

          div.onclick = () => {
            if (!unlocked) return;
            if (done) completed.splice(completed.indexOf(name), 1);
            else completed.push(name);
            localStorage.setItem('completedCourses', JSON.stringify(completed));
            location.reload();
          };

          col.appendChild(div);
        });

        grid.appendChild(col);
      }

      document.body.appendChild(grid);
    }

    function applyColorOverrides() {
      const mode = document.body.classList.contains('dark-mode') ? 'dark' : 'light';
      const root = document.documentElement;
      const vars = ['bg-color', 'column-bg', 'primary-text', 'course-bg', 'completed-bg', 'locked-bg'];
      vars.forEach(v => {
        const saved = localStorage.getItem(`${mode}-${v}`);
        if (saved) root.style.setProperty(`--${v}`, saved);
      });
    }

    function saveCustomColors() {
      const mode = document.getElementById('modeSelector').value;
      const vars = ['bg-color', 'column-bg', 'primary-text', 'course-bg', 'completed-bg', 'locked-bg'];
      vars.forEach(v => {
        const color = document.getElementById(v).value;
        localStorage.setItem(`${mode}-${v}`, color);
      });
      alert('Colores guardados');
      location.reload();
    }

    function resetColors() {
      const mode = document.getElementById('modeSelector').value;
      const vars = ['bg-color', 'column-bg', 'primary-text', 'course-bg', 'completed-bg', 'locked-bg'];
      vars.forEach(v => localStorage.removeItem(`${mode}-${v}`));
      alert('Colores restablecidos');
      location.reload();
    }

    document.getElementById('colorBtn').onclick = () => {
      document.getElementById('colorPanel').style.display = 'flex';
    };

    document.getElementById('darkModeBtn').onclick = () => {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
      applyColorOverrides();
    };

    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
    }

    applyColorOverrides();
    updateTesisProgress();
    render();
  </script>
</body>
</html>
