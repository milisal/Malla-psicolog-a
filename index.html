<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Malla Curricular Psicología</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-bg: #fff8fb;
      --color-primary: #c71585;
      --color-primary-light: #f4c1d9;
      --color-accent: #a0006d;
      --color-completed-bg: #d4edda;
      --color-locked-bg: #f8d7da;
      --color-course-bg: #ffcce5;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: var(--color-bg);
      margin: 0;
      padding: 20px;
      color: #444;
    }

    h1 {
      text-align: center;
      color: var(--color-primary);
      font-weight: 700;
      margin-bottom: 30px;
    }

    .progress {
      text-align: center;
      margin: 20px auto 40px;
      font-size: 1.2em;
      color: var(--color-accent);
      font-weight: 600;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      padding: 10px;
    }

    .column {
      background: #fff;
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 4px 8px rgb(199 21 133 / 0.2);
      border: 2px solid var(--color-primary-light);
    }

    .column h2 {
      text-align: center;
      color: var(--color-primary);
      margin-bottom: 15px;
      font-weight: 600;
      font-size: 1.3em;
    }

    .course {
      background: var(--color-course-bg);
      border-radius: 12px;
      padding: 12px 15px;
      margin: 8px 0;
      cursor: pointer;
      position: relative;
      box-shadow: 0 2px 6px rgb(243 151 194 / 0.4);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .course:hover:not(.locked):not(.completed) {
      background-color: var(--color-primary-light);
      box-shadow: 0 4px 12px rgb(199 21 133 / 0.4);
    }

    .course.locked {
      background-color: var(--color-locked-bg);
      cursor: default;
      opacity: 0.7;
      box-shadow: none;
    }

    .course.completed {
      background-color: var(--color-completed-bg);
      text-decoration: line-through;
      cursor: pointer;
      box-shadow: 0 2px 6px rgb(21 133 70 / 0.3);
    }

    .course .checkmark {
      color: #2e7d32;
      font-weight: bold;
      font-size: 1.2em;
      margin-left: 10px;
    }

    .tooltip {
      visibility: hidden;
      background-color: #555;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 6px 10px;
      position: absolute;
      z-index: 10;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s ease;
      width: max-content;
      max-width: 200px;
      font-size: 0.85em;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    }

    .tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -6px;
      border-width: 6px;
      border-style: solid;
      border-color: #555 transparent transparent transparent;
    }

    .course:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Lic. en Psicología</h1>
  <div class="progress" id="tesisProgress">Progreso hacia Tesis: 0/0 materias completadas</div>
  <div class="grid" id="curriculum"></div>

  <script>
    const data = {
      'CBC': [
        'Biología', 'Semiología', 'Psicología', 'Pensamiento científico', 'Matemática', 'Sociedad y Estado'
      ],
      'Formación General': [
        { name: 'Psicología General', reqs: ['CBC'] },
        { name: 'Estadística', reqs: ['CBC'] },
        { name: 'Psicología Social', reqs: ['CBC'] },
        { name: 'Psicoanálisis Freud', reqs: ['CBC'] },
        { name: 'Psic. Y Epist. Genética', reqs: ['CBC'] },
        { name: 'Neurofisiología', reqs: ['CBC'] },
        { name: 'Historia de la Psicología', reqs: ['Psicología General'] },
        { name: 'Metodología de la Investigación', reqs: ['Psicología General', 'Estadística'] },
        { name: 'Salud Pública y Mental', reqs: ['Psicología Social', 'Metodología de la Investigación'] },
        { name: 'Teoría y Técnica de Grupos', reqs: ['Psicología Social', 'Psicoanálisis Freud'] },
        { name: 'Ps. Evolutiva Niñez', reqs: ['Psicoanálisis Freud', 'Psic. Y Epist. Genética'] },
        { name: 'Ps. Evolutiva Adolescencia', reqs: ['Ps. Evolutiva Niñez'] },
        { name: 'Psicopatología', reqs: ['Neurofisiología', 'Ps. Evolutiva Adolescencia'] },
        { name: 'T. Y T de Explor. Diag. Ps. Mód I', reqs: ['Metodología de la Investigación', 'Psicopatología'] },
        { name: 'T. Y T de Explor. Diag. Ps. Mód II', reqs: ['T. Y T de Explor. Diag. Ps. Mód I'] },
        { name: 'Materia Electiva I' },
        { name: 'Requisito Idioma', reqs: ['Psicología General', 'Psicoanálisis Freud'] },
        { name: 'Materia Electiva II' }
      ],
      'Formación Profesional': [
        { name: 'Ps. Ética y DDHH', reqs: ['Psicología Social', 'Historia de la Psicología'] },
        { name: 'Psicología Educacional', reqs: ['Salud Pública y Mental', 'Teoría y Técnica de Grupos', 'Ps. Evolutiva Adolescencia'] },
        { name: 'Psicología Institucional', reqs: ['Salud Pública y Mental', 'Teoría y Técnica de Grupos'] },
        { name: 'Psicología del Trabajo', reqs: ['Salud Pública y Mental', 'Teoría y Técnica de Grupos', 'T. Y T de Explor. Diag. Ps. Mód II'] },
        { name: 'CP y P. Clínica de Adultos', reqs: ['T. Y T de Explor. Diag. Ps. Mód II'] },
        { name: 'Psicología Jurídica', reqs: ['T. Y T de Explor. Diag. Ps. Mód II'] },
        { name: 'Psicoterapias', reqs: ['T. Y T de Explor. Diag. Ps. Mód II'] },
        { name: 'Práctica prof. o de Investigación', reqs: ['Psicología General','Estadística','Psicología Social','Psicoanálisis Freud','Psic. Y Epist. Genética','Neurofisiología','Historia de la Psicología','Metodología de la Investigación','Salud Pública y Mental','Teoría y Técnica de Grupos','Ps. Evolutiva Niñez','Ps. Evolutiva Adolescencia','Psicopatología','T. Y T de Explor. Diag. Ps. Mód I','T. Y T de Explor. Diag. Ps. Mód II','Requisito Idioma'] },
        { name: 'Materia Electiva/Práctica', reqs: ['Psicología General','Estadística','Psicología Social','Psicoanálisis Freud','Psic. Y Epist. Genética','Neurofisiología','Historia de la Psicología','Metodología de la Investigación','Salud Pública y Mental','Teoría y Técnica de Grupos','Ps. Evolutiva Niñez','Ps. Evolutiva Adolescencia','Psicopatología','T. Y T de Explor. Diag. Ps. Mód I','T. Y T de Explor. Diag. Ps. Mód II','Requisito Idioma'] },
        { name: 'Materia Electiva III', reqs: ['Psicología General','Estadística','Psicología Social','Psicoanálisis Freud','Psic. Y Epist. Genética','Neurofisiología','Historia de la Psicología','Metodología de la Investigación','Salud Pública y Mental','Teoría y Técnica de Grupos','Ps. Evolutiva Niñez','Ps. Evolutiva Adolescencia','Psicopatología','T. Y T de Explor. Diag. Ps. Mód I','T. Y T de Explor. Diag. Ps. Mód II','Requisito Idioma'] },
        { name: 'Materia Electiva IV', reqs: ['Psicología General','Estadística','Psicología Social','Psicoanálisis Freud','Psic. Y Epist. Genética','Neurofisiología','Historia de la Psicología','Metodología de la Investigación','Salud Pública y Mental','Teoría y Técnica de Grupos','Ps. Evolutiva Niñez','Ps. Evolutiva Adolescencia','Psicopatología','T. Y T de Explor. Diag. Ps. Mód I','T. Y T de Explor. Diag. Ps. Mód II','Requisito Idioma'] },
        { name: 'Requisito Tesis', reqs: [
          'Biología', 'Semiología', 'Psicología', 'Pensamiento científico', 'Matemática', 'Sociedad y Estado',
          'Psicología General', 'Estadística', 'Psicología Social', 'Psicoanálisis Freud', 'Psic. Y Epist. Genética',
          'Neurofisiología', 'Historia de la Psicología', 'Metodología de la Investigación', 'Salud Pública y Mental',
          'Teoría y Técnica de Grupos', 'Ps. Evolutiva Niñez', 'Ps. Evolutiva Adolescencia', 'Psicopatología',
          'T. Y T de Explor. Diag. Ps. Mód I', 'T. Y T de Explor. Diag. Ps. Mód II', 'Materia Electiva I',
          'Requisito Idioma', 'Materia Electiva II', 'Ps. Ética y DDHH', 'Psicología Educacional', 'Psicología Institucional',
          'Psicología del Trabajo', 'CP y P. Clínica de Adultos', 'Psicología Jurídica', 'Psicoterapias',
          'Práctica prof. o de Investigación', 'Materia Electiva/Práctica', 'Materia Electiva III', 'Materia Electiva IV'
        ] }
      ]
    };

    const completed = JSON.parse(localStorage.getItem('completedCourses') || '[]');

    function isCompleted(name) {
      return completed.includes(name);
    }

    function checkRequirements(reqs) {
      if (!reqs || reqs.length === 0) return true;
      return reqs.every(r => {
        if (r === 'CBC') {
          return data['CBC'].every(isCompleted);
        } else {
          return isCompleted(r);
        }
      });
    }

    function updateTesisProgress() {
      const tesis = data['Formación Profesional'].find(c => c.name === 'Requisito Tesis');
      const total = tesis.reqs.length;
      const done = tesis.reqs.filter(isCompleted).length;
      document.getElementById('tesisProgress').textContent = `Progreso hacia Tesis: ${done}/${total} materias completadas`;
    }

    function render() {
      updateTesisProgress();
      const container = document.getElementById('curriculum');
      container.innerHTML = '';
      for (const [cycle, courses] of Object.entries(data)) {
        const col = document.createElement('div');
        col.className = 'column';
        col.innerHTML = `<h2>${cycle}</h2>`;

        courses.forEach(course => {
          const name = typeof course === 'string' ? course : course.name;
          const reqs = typeof course === 'string' ? [] : course.reqs;
          const isDone = isCompleted(name);
          const unlocked = checkRequirements(reqs);

          const div = document.createElement('div');
          div.className = 'course';
          if (isDone) div.classList.add('completed');
          if (!unlocked) div.classList.add('locked');

          const label = document.createElement('span');
          label.textContent = name;
          div.appendChild(label);

          if (isDone) {
            const check = document.createElement('span');
            check.className = 'checkmark';
            check.textContent = '✓';
            div.appendChild(check);
          }

          if (!unlocked && reqs.length) {
            const tooltip = document.createElement('span');
            tooltip.className = 'tooltip';
            const unmet = reqs.filter(r => r === 'CBC' ? !data['CBC'].every(isCompleted) : !isCompleted(r));
            tooltip.textContent = `Falta: ${unmet.join(', ')}`;
            div.appendChild(tooltip);
          }

          div.onclick = () => {
            if (!unlocked) return;
            if (isDone) {
              completed.splice(completed.indexOf(name), 1);
            } else {
              completed.push(name);
            }
            localStorage.setItem('completedCourses', JSON.stringify(completed));
            render();
          };

          col.appendChild(div);
        });

        container.appendChild(col);
      }
    }

    render();
  </script>
</body>
</html>
